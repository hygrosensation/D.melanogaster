---
title: "Untitled"
output: html_document
date: "2024-05-03"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)

```


```{r }
# Done only once

#colNames = c("OrthoDB_unique_gene_id","OrthoDB_individual_organism_id",
 "protein_original_sequence_id",
 "synonyms","Uniprot_id","ids_from_Ensembl","NCBI_gid","description")

#ODB = read_tsv("~/Downloads/odb11v0_genes.tab")
#colnames(ODB)  = colNames
#species = read_tsv("~/Downloads/odb11v0_species.tab",col_names = FALSE)
#colnames(spe)

#species %>% filter(grepl(pattern = "Drosophila",X3)) -> species.Drosophila
#species %>% filter(grepl(pattern = "Aedes aegypti",X3)) -> species.Aedes
#species %>% filter(grepl(pattern = "Ooceraea",X3)) -> species.Ooceraea

#species.OI = bind_rows(species.Drosophila,species.Aedes,species.Ooceraea)

#ODB %>% filter(OrthoDB_individual_organism_id %in% species.OI$X2) ->
#  ODB.OI

#species %>% filter(grepl(pattern = "Drosophila melanogaster",X3)) -> species.Drosophila
#species %>% filter(grepl(pattern = "Aedes aegypti",X3)) -> species.Aedes
#species %>% filter(grepl(pattern = "Ooceraea",X3)) -> species.Ooceraea

#species.OI2 = bind_rows(species.Drosophila,species.Aedes,species.Ooceraea)

#ODB.OI%>% filter(OrthoDB_individual_organism_id %in% species.OI2$X2) ->
#  ODB.OI2
#ODB.OI2 %>% select(OrthoDB_individual_organism_id,X3,OrthoDB_unique_gene_id,synonyms,NCBI_gid,description) %>%
#  rename(species = "X3") ->
#  ODB.OI2

#ODB.OI2  %>% group_by(species) %>% summarise(n = n())


#OG2genes %>%
#  rename(OG = "X1", OrthoDB_unique_gene_id = "X2")->
#  OG2genes

#OG2genes %>% inner_join(ODB.OI2) -> 
#  ODB.OI2.OG

#read_tsv("~/Downloads/odb11v0_OG2genes.tab.gz",col_names = FALSE) -> OG2genes




#write_csv(ODB.OI2.OG,gzfile('data/orthoGroups/OG.geneID.all.csv.gz'))

```

```{r}
ODB.OI2.OG = read_csv('../data/orthoGroups/OG.geneID.all.csv.gz')

ODB.OI2.OG %>% distinct(OG,species) %>%
  group_by( OG) %>%
  summarise(n = n() ) %>%
  group_by(n) %>%
  summarise(n2= n() )


ODB.OI2.OG %>%
  distinct(OG,species) %>%
  group_by( OG) %>%
  summarise(n = n() ) %>%
  filter(n == 3) %>%
  inner_join(ODB.OI2.OG)->
  ODB.OI2.OG.common



ODB.OI2.OG.common %>%
  filter(species == "Drosophila melanogaster") %>%
  distinct(NCBI_gid)
  

write_csv(ODB.OI2.OG.common,gzfile('../data/orthoGroups/OG.geneID.common.csv.gz'))


```




```{r}
Ants = read_csv2("../data/orthoGroups/Ants.csv") %>% mutate(synonyms = gene) %>%
  select(cluster,synonyms) %>% rename(AntsCluster = "cluster") %>%
  mutate(species = "Ooceraea biroi")

Dros = read_csv2("../data/orthoGroups/Droso.csv") %>% mutate(synonyms = gene) %>%
  select(cluster,synonyms) %>% rename(FlyCluster = "cluster")%>%
  mutate(species = "Drosophila melanogaster")

Mozz = read_csv2("../data/orthoGroups/Mozz.csv") %>% mutate(synonyms = gene) %>%
  select(cluster,synonyms) %>% rename(MozzCluster = "cluster")%>%
  mutate(species = "Aedes aegypti")


ODB.OI2.OG.common %>%
  inner_join(Dros) %>%
  filter(FlyCluster %in% c(18,36,47)) %>%
  distinct(OG) %>% 
  inner_join(ODB.OI2.OG.common) %>%
  filter(species == "Ooceraea biroi") %>%
  distinct(synonyms,species) %>%
  inner_join(Ants) %>%
  group_by(species,AntsCluster) %>%
  summarise(n = n()) %>%
  arrange(-n)
  
ODB.OI2.OG.common %>%
  inner_join(Dros) %>%
  filter(FlyCluster %in% c(18,36,47)) %>%
  distinct(OG) %>% 
  inner_join(ODB.OI2.OG.common) %>%
  filter(species == "Aedes aegypti") %>%
  distinct(synonyms,species) %>%
  inner_join(Mozz) %>%
  group_by(species,MozzCluster) %>%
  summarise(n = n()) %>%
  arrange(-n)



```
